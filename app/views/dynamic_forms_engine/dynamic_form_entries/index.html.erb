<div class="row">
  <div class="col-md-12">

    <ol class="breadcrumb header">
      <li><%= link_to "Forms", '' %></li>
      <li>All Entries</li>
    </ol>

  </div>

</div>

<fieldset>
  <%= form_for(:search, :url => dynamic_form_entries_path, :html => { :method => :get }) do  %>
    <div class="row">
      <div class="col-xs-6 col-sm-3">
        <%= select("search","name", @entries_name || '', {:prompt => 'Select Form Type'},:class => 'form-control')  %>
      </div>
      <div class="col-xs-3 col-sm-3">
        <%= text_field 'search', 'properties', :class => "col-xs-6 form-control", :placeholder => "Enter properties like" %>
      </div>
      <div class="col-md-3">
        <div class="input-daterange input-group date">
          <%= text_field 'search', 'start', :class => "form-control", :placeholder => "Start Date" %>
          <span class="input-group-addon">to</span>
           <%= text_field 'search', 'end', :class => "form-control", :placeholder => "End Date" %>
        </div>
      </div>

      <% if params[:search]
        print_url = request.original_url.sub!('dynamic_form_entries?','dynamic_form_entries.print?')
      else
        print_url = dynamic_form_entries_path(format: :print)
      end %>

      <div class="col-xs-6 col-sm-3">
        <div class="btn-group pull-right">
          <%= link_to "Reset", dynamic_form_entries_path, :class => 'btn btn-danger' %>
          <button type="submit" class="btn btn-info"><i class="fa fa-search"></i> Search</button>
          <%= link_to print_url,:class => 'print-index btn btn-success' do %>
            <i class="fa fa-print"></i> Print
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</fieldset>
<%= content_tag :div, nil, class: 'clear spacer' %>

<table class="table table-striped table-hover">
  <thead>
    <tr class="well">
      <th>Type</th>
      <th>Properties</th>
      <th>Status</th>
      <th>Submitted</th>
      <th width="1%"></th>
      <th width="1%"></th>
      <th width="1%"></th>
      <th width="1%"></th>
    </tr>
  </thead>


  <tbody>
    <% if !@dynamic_form_entries.blank? %>
      <% @dynamic_form_entries.each do |dynamic_form_entry| %>
        <tr>
          <td><strong><%= dynamic_form_entry.dynamic_form_type.name %></strong></td>

          <td class="form-properties">
              <% dynamic_form_entry.properties.first(5).each do |key,value| %>
                <li><%= value[:type] %> field</li>
              <% end %>
          </td>

          <td>
            <% if dynamic_form_entry.in_progress %>
              <%= link_to edit_dynamic_form_entry_path(dynamic_form_entry), :class => 'btn btn-danger' do %>
                <i class="fa fa-pencil-square-o"></i> IN DRAFT
              <% end %>
            <% else %>
              <%= link_to dynamic_form_entry, :class => 'btn btn-success' do %>
                <i class="fa fa-check"></i> SUBMITTED
              <% end %>
            <% end %>
          </td>

          <td>
            <%= dynamic_form_entry.created_at.strftime(" %l:%M %p %b. %d, %Y") %>
          </td>

          <td>
            <%= link_to 'CSV', dynamic_form_entry_path(dynamic_form_entry, format: :csv), :class => 'btn btn-default' %>
          </td>
          <td>
            <%= link_to 'XML', dynamic_form_entry_path(dynamic_form_entry, format: :xml), :class => 'btn btn-default'%>
          </td>
          <td>
            <%= link_to 'View', dynamic_form_entry, :class => 'btn btn-info' %>
          </td>

        </tr>
      <% end %>
    <% else %>
      <tr>
        <td>You have no entries!</td>
      </tr>
    <% end %>
  </tbody>
</table>

  <% if request.original_url =~ /(.print)/ %>
    <%= javascript_tag "window.print()" %>
  <% end %>


<script type="text/javascript">
  $(document).ready(function(){
    $('.date input').datepicker({
    });
  });
</script>
